name: 📊 Data Repository CI / فحص مستودع البيانات

on:
  push:
    branches: [ "main" ]
    paths:
      - '**.md'
      - '**.html'
      - '**.yml'
      - '**.yaml'
      - '.github/workflows/**'
  pull_request:
    branches: [ "main" ]
    paths:
      - '**.md'
      - '**.html'
      - '**.yml'
      - '**.yaml'
      - '.github/workflows/**'

jobs:
  validate:
    name: 🔍 Validate Repository / التحقق من المستودع
    runs-on: ubuntu-latest

    steps:
    - name: 📥 Checkout code / تحميل الكود
      uses: actions/checkout@v4
      with:
        lfs: true
        
    - name: 🔍 Validate markdown files / التحقق من ملفات markdown
      run: |
        echo "🔍 فحص ملفات Markdown..."
        echo "🔍 Validating markdown files..."
        
        # Check for broken markdown / فحص Markdown المكسور
        find . -name "*.md" -not -path "./.git/*" | while read file; do
          echo "Checking $file"
          # Basic markdown validation can be added here
        done
        
    - name: 📋 Check repository structure / فحص بنية المستودع
      run: |
        echo "📋 فحص بنية المستودع..."
        echo "📋 Checking repository structure..."
        
        # Verify essential files exist / التحقق من وجود الملفات الأساسية
        if [ ! -f "README.md" ]; then
          echo "⚠️ README.md مفقود"
          echo "⚠️ README.md is missing"
        fi
        
        if [ ! -f ".gitignore" ]; then
          echo "⚠️ .gitignore مفقود"
          echo "⚠️ .gitignore is missing"
        fi
        
        if [ ! -f ".gitattributes" ]; then
          echo "⚠️ .gitattributes مفقود"
          echo "⚠️ .gitattributes is missing"
        fi
        
        echo "✅ تم إكمال فحص البنية"
        echo "✅ Structure check completed"
        
    - name: 🎯 Check Git LFS files / فحص ملفات Git LFS
      run: |
        echo "🎯 فحص ملفات Git LFS..."
        echo "🎯 Checking Git LFS files..."
        
        # List LFS files / قائمة ملفات LFS
        git lfs ls-files
        
        # Check LFS file integrity / فحص سلامة ملفات LFS
        git lfs fsck
        
        echo "✅ تم إكمال فحص Git LFS"
        echo "✅ Git LFS check completed"
